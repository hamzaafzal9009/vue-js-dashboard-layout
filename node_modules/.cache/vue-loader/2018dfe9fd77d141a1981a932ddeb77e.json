{"remainingRequest":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/Library/WebServer/Documents/Projects/vue/mViteDashboard/src/components/Riders.vue?vue&type=style&index=0&id=7ed70a2e&scoped=true&lang=css&","dependencies":[{"path":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/src/components/Riders.vue","mtime":1615666759078},{"path":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Library/WebServer/Documents/Projects/vue/mViteDashboard/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmdyZXktdGV4dCB7CiAgY29sb3I6ICNjZWNlY2U7Cn0KLmdyZWVuLXRleHQgewogIGNvbG9yOiBkYXJrZ3JlZW47Cn0KCi5pbWctdXNlciB7CiAgd2lkdGg6IDUwcHg7CiAgaGVpZ2h0OiA1MHB4OwogIGJvcmRlci1yYWRpdXM6IDUwJTsKfQoKLmRyaXZlci1uYW1lIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAyNnB4OwogIGxlZnQ6IDgwcHg7Cn0KLnRleHQtY2VudGVyIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0K"},{"version":3,"sources":["Riders.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAseA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Riders.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"dashboard-container\">\n    <el-card class=\"card-min-height\">\n      <div class=\"card-header\">\n        <div class=\"card-title\">\n          <h3>Riders</h3>\n        </div>\n        <!-- <div class=\"card-actions\">\n          <div class=\"input-group\">\n            <el-popover\n              trigger=\"click\"\n              class=\"filter clickable\"\n              v-model=\"showFilters\"\n            >\n              <div class=\"filter-button\" slot=\"reference\">\n                <i class=\"fas fa-filter\"></i>\n              </div>\n              <div class=\"dropdown-filter-menu\">\n                <div class=\"dropdown-filter-option\">\n                  <label>Search By</label>\n                  <el-select v-model=\"search_by\" :collapse-tags=\"true\">\n                    <el-option class=\"capitalize\" value=\"Full Name\"\n                      >Full Name\n                    </el-option>\n                    <el-option class=\"capitalize\" value=\"Email\"\n                      >Email\n                    </el-option>\n                    <el-option class=\"capitalize\" value=\"Phone Number\"\n                      >Phone Number\n                    </el-option>\n                  </el-select>\n                </div>\n              </div>\n            </el-popover>\n            <el-input\n              placeholder=\"Search Driver\"\n              @input=\"searchBy\"\n              v-model=\"search\"\n              ><i slot=\"suffix\" class=\"far fa-search\"></i\n            ></el-input>\n          </div>\n        </div> -->\n      </div>\n\n      <div class=\"card-body\">\n        <el-tabs\n          v-model=\"activeName\"\n          @tab-click=\"setStatusFilter\"\n          type=\"border-card\"\n        >\n          <el-tab-pane\n            :label=\"tab.text\"\n            :name=\"tab.name\"\n            v-for=\"(tab, index) in tabs\"\n            :key=\"index\"\n          >\n            <el-table\n              :data=\"tripFilterData\"\n              style=\"width: 100%\"\n              size=\"small\"\n              empty-text=\"No results found.\"\n            >\n              <el-table-column label=\"Date\">\n                <template slot-scope=\"props\">\n                  <div v-if=\"status === 'Requested Rides'\">\n                    <div>\n                      {{ returnDate(props.row.createdAt) }}\n                    </div>\n                    <div class=\"caption\">\n                      {{ returnTime(props.row.createdAt) }}\n                    </div>\n                  </div>\n                  <div v-else>\n                    {{ props.row.parentDate || \"No Date Available\" }}\n                  </div>\n                </template>\n              </el-table-column>\n\n              <el-table-column\n                prop=\"driverFirstName\"\n                label=\"Full Name\"\n                width=\"200\"\n              >\n                <template slot-scope=\"props\">\n                  <span>\n                    <img\n                      :src=\"\n                        !props.row.userAvatarUrl ||\n                        props.row.userAvatarUrl === 'N/A'\n                          ? require(`@/assets/img/default-user.jpg`)\n                          : props.row.userAvatarUrl\n                      \"\n                      class=\"img-user\"\n                      alt=\"...\"\n                    />\n                  </span>\n                  <span v-if=\"typeof props === 'object'\" class=\"driver-name\">\n                    {{ props.row.userFullName }}\n                  </span>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"userEmail\" label=\"Email\">\n              </el-table-column>\n\n              <el-table-column prop=\"userPhoneNumber\" label=\"Phone Number\">\n              </el-table-column>\n              <el-table-column prop=\"userTotalRating\" label=\"Total Rating\">\n                <template slot-scope=\"props\">\n                  <span\n                    v-if=\"\n                      props.row.userTotalRating &&\n                        props.row.userTotalRating !== ''\n                    \"\n                  >\n                    <el-tooltip\n                      class=\"item\"\n                      effect=\"dark\"\n                      :content=\"props.row.userTotalRating\"\n                      placement=\"left\"\n                    >\n                      <el-rate\n                        :value=\"parseInt(props.row.userTotalRating)\"\n                        disabled\n                      >\n                      </el-rate>\n                    </el-tooltip>\n                  </span>\n                  <span v-else>\n                    No Data Available\n                  </span>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"totalTrips\" label=\"Total Trips\">\n                <template slot-scope=\"props\">\n                  <span v-if=\"props.row.totalTrips\">\n                    {{ props.row.totalTrips }} Trip(s)\n                  </span>\n                  <span v-else>\n                    No Data Available\n                  </span>\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"regDate\" label=\"Reg Date\">\n                <template slot-scope=\"props\">\n                  {{ props.row.regDate || \"No Data Available\" }}\n                </template>\n              </el-table-column>\n              <el-table-column fixed=\"right\" label=\"Actions\" width=\"140\">\n                <template slot-scope=\"props\">\n                  <el-tooltip\n                    v-if=\"\n                      props.row.isBlocked === 'false' ||\n                        props.row.isBlocked === false\n                    \"\n                    class=\"item\"\n                    effect=\"dark\"\n                    content=\"Block Rider\"\n                    placement=\"top\"\n                  >\n                    <el-button\n                      type=\"default\"\n                      icon=\"el-icon-close\"\n                      circle\n                      plain\n                      size=\"mini\"\n                      @click=\"doIt(props.row, 'block')\"\n                    ></el-button>\n                  </el-tooltip>\n                  <el-tooltip\n                    v-if=\"\n                      props.row.isBlocked === 'true' ||\n                        props.row.isBlocked === true\n                    \"\n                    class=\"item\"\n                    effect=\"dark\"\n                    content=\"Unblock Rider\"\n                    placement=\"top\"\n                  >\n                    <el-button\n                      type=\"default\"\n                      icon=\"el-icon-check\"\n                      circle\n                      plain\n                      size=\"mini\"\n                      @click=\"doIt(props.row, 'unblock')\"\n                    ></el-button>\n                  </el-tooltip>\n                  <el-tooltip\n                    class=\"item\"\n                    effect=\"dark\"\n                    content=\"Edit Driver\"\n                    placement=\"top\"\n                  >\n                    <el-button\n                      type=\"primary\"\n                      icon=\"el-icon-edit\"\n                      circle\n                      plain\n                      size=\"mini\"\n                      @click=\"\n                        $router.push(\n                          `/riders/edit/${props.row.userPhoneNumber}`\n                        )\n                      \"\n                    ></el-button>\n                  </el-tooltip>\n                  <el-tooltip\n                    class=\"item\"\n                    effect=\"dark\"\n                    content=\"Delete Driver\"\n                    placement=\"top\"\n                  >\n                    <el-button\n                      type=\"danger\"\n                      icon=\"el-icon-delete\"\n                      circle\n                      plain\n                      size=\"mini\"\n                      @click=\"doIt(props.row, 'delete')\"\n                    ></el-button>\n                  </el-tooltip>\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-tab-pane>\n        </el-tabs>\n      </div>\n      <div class=\"pagination block\">\n        <span\n          >Showing {{ paginationData.perPage }} of\n          {{ paginationData.total }} Total Results</span\n        >\n        <el-pagination\n          background\n          layout=\"prev, pager, next\"\n          :current-page=\"paginationPage\"\n          :page-size=\"paginationData.perPage\"\n          :total=\"paginationData.total\"\n          small\n          @current-change=\"addPageNum\"\n        ></el-pagination>\n        <el-select\n          class=\"per-page-select\"\n          size=\"mini\"\n          v-model=\"paginationData.perPage\"\n        >\n          <el-option\n            v-for=\"option in paginationData.perPageOptions\"\n            :value=\"option\"\n            :key=\"option\"\n            >{{ option }}\n          </el-option>\n        </el-select>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport firebase from \"firebase/app\";\nconst db = firebase.firestore();\nconst ridersRef = db.collection(\"riders\");\nconst requestRides = db.collection(\"requestedRides\");\nconst vehiclesRef = db.collection(\"vehicles\");\nimport { EventService } from \"../main\";\n\nexport default {\n  name: \"Riders\",\n  data: () => ({\n    tabs: [\n      {\n        text: \"All\",\n        name: \"first\",\n      },\n      {\n        text: \"Active\",\n        name: \"second\",\n      },\n      {\n        text: \"Blocked\",\n        name: \"third\",\n      },\n      {\n        text: \"Requested Rides\",\n        name: \"forth\",\n      },\n    ],\n    search_by: \"\",\n    status: \"All\",\n    search: \"\",\n    ridersData: [],\n    comfirmationBox: false,\n    message: \"\",\n    showFilters: false,\n    currentAction: \"\",\n    loading: false,\n    tripsDetail: {},\n    tripsInfo: [],\n    dailyEarningDetail: {},\n    authUser: {},\n    ridersHistory: [],\n    currentId: \"\",\n    filters: {\n      full_name: \"\",\n      phone_number: \"\",\n      email: \"\",\n    },\n    activeName: \"first\",\n    paginationData: {\n      perPage: 10,\n      currentPage: 0,\n      perPageOptions: [10, 20, 50],\n      total: 0,\n    },\n  }),\n  computed: {\n    ridersDetail() {\n      return this.ridersData.filter(\n        (el) => typeof el.userFullName !== \"undefined\"\n      );\n    },\n    statusFilterData() {\n      if (this.status === \"Requested Rides\") {\n        return [];\n      }\n      return this.ridersDetail\n        .slice()\n        .sort((a, b) => b.updatedAt - a.updatedAt)\n        .filter((ele) => {\n          if (ele.userFullName && ele.userPhoneNumber && ele.userEmail) {\n            if (this.status === \"Active\") {\n              return ele.isBlocked === \"false\" || ele.isBlocked === false;\n            } else if (this.status === \"Blocked\") {\n              return ele.isBlocked === \"true\" || ele.isBlocked === true;\n            } else {\n              return ele;\n            }\n          }\n        });\n    },\n    tripFilterData() {\n      const start =\n          this.paginationData.currentPage * this.paginationData.perPage,\n        end = start + this.paginationData.perPage;\n      this.paginationData.total = this.statusFilterData.length;\n      // return this.statusFilterData.slice(start, end);\n      return this.statusFilterData\n        .filter((ele) => {\n          return (\n            ele.userFullName\n              .toLowerCase()\n              .includes(this.filters.full_name.toLowerCase() || \"\") &&\n            ele.userPhoneNumber\n              .toLowerCase()\n              .includes(this.filters.phone_number.toLowerCase() || \"\") &&\n            ele.userEmail\n              .toLowerCase()\n              .includes(this.filters.email.toLowerCase() || \"\")\n          );\n        })\n        .slice(start, end);\n    },\n    paginationPage() {\n      return this.paginationData.currentPage + 1;\n    },\n  },\n  created() {\n    this.getRiders();\n  },\n  methods: {\n    searchBy() {\n      if (this.search_by === \"Email\") {\n        this.filters.email = this.search;\n      } else if (this.search_by === \"Phone Number\") {\n        this.filters.phone_number = this.search;\n      } else {\n        this.filters.full_name = this.search;\n      }\n    },\n    addPageNum(page) {\n      this.paginationData.currentPage = page - 1;\n    },\n    getRequestedRides() {\n      this.requestedRides = [];\n      requestRides.get().then((data) => {\n        const response = data.docs.map((value) => value.data());\n        const rides = Object.keys(response);\n        if (rides.length) {\n          rides.forEach((x) => {\n            const items = this.driverData.find((y) => y.userId === x);\n            if (items) {\n              this.requestedRides.push({\n                ...items,\n                createdAt: response[x],\n              });\n            }\n          });\n          this.loading = false;\n        }\n      });\n    },\n    getRiders() {\n      EventService.$emit(\"loading\", \"show\");\n      ridersRef.get().then((data) => {\n        this.ridersData = data.docs.map((value) => value.data());\n        console.dir(this.ridersData);\n        EventService.$emit(\"loading\", \"hide\");\n      });\n    },\n    setStatusFilter(tab, event) {\n      this.status = tab.label;\n      this.activeName = tab.name;\n    },\n    returnDate(date) {\n      const humanDate = new Date(parseInt(date));\n      return humanDate.toDateString().substring(4, 16);\n    },\n    returnTime(date) {\n      const humanDate = new Date(parseInt(date));\n      return humanDate.toString().substring(16, 24);\n    },\n    doIt(details, action) {\n      this.$confirm(`Are you sure you want to ${action} this rider?`)\n        .then((_) => {\n          this.currentId = details.userId;\n          EventService.$emit(\"loading\", \"show\");\n          if (action === \"block\") {\n            this.blockUser();\n          } else if (action === \"unblock\") {\n            this.unBlockUser();\n          } else if (action === \"delete\") {\n            this.deleteRider();\n          }\n        })\n        .catch((_) => {});\n    },\n    deleteRider() {\n      ridersRef\n        .doc(this.currentId)\n        .delete()\n        .then(() => {\n          EventService.$emit(\"loading\", \"hide\");\n          EventService.$emit(\"successMessage\", \"Rider Deleted Successfully\");\n          this.getRiders();\n        })\n        .catch((err) => {\n          EventService.$emit(\"loading\", \"hide\");\n          console.error(err);\n          EventService.$emit(\"errorMessage\", \"Something Went Wrong!\");\n        });\n    },\n    blockUser() {\n      ridersRef\n        .doc(this.currentId)\n        .update({ isBlocked: true })\n        .then(() => {\n          EventService.$emit(\"loading\", \"hide\");\n          EventService.$emit(\"successMessage\", \"Rider Blocked Successfully\");\n          this.getRiders();\n        })\n        .catch((err) => {\n          EventService.$emit(\"loading\", \"hide\");\n          console.error(err);\n          EventService.$emit(\"errorMessage\", \"Something Went Wrong!\");\n        });\n    },\n    unBlockUser() {\n      ridersRef\n        .doc(this.currentId)\n        .update({ isBlocked: false })\n        .then(() => {\n          EventService.$emit(\"loading\", \"hide\");\n          EventService.$emit(\"successMessage\", \"Rider Unblocked Successfully\");\n          this.getRiders();\n        })\n        .catch((err) => {\n          EventService.$emit(\"loading\", \"hide\");\n          console.error(err);\n          EventService.$emit(\"errorMessage\", \"Something Went Wrong!\");\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.grey-text {\n  color: #cecece;\n}\n.green-text {\n  color: darkgreen;\n}\n\n.img-user {\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n}\n\n.driver-name {\n  position: absolute;\n  top: 26px;\n  left: 80px;\n}\n.text-center {\n  text-align: center;\n}\n</style>\n"]}]}