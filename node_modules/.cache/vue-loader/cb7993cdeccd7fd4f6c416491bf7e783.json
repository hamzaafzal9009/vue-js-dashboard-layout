{"remainingRequest":"/Library/WebServer/Documents/Projects/vue/m-driver-dashboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/Library/WebServer/Documents/Projects/vue/m-driver-dashboard/src/components/DashboardComponents/TripHistory.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Library/WebServer/Documents/Projects/vue/m-driver-dashboard/src/components/DashboardComponents/TripHistory.vue","mtime":1618925633072},{"path":"/Library/WebServer/Documents/Projects/vue/m-driver-dashboard/node_modules/babel-loader/lib/index.js","mtime":1618923163808},{"path":"/Library/WebServer/Documents/Projects/vue/m-driver-dashboard/node_modules/cache-loader/dist/cjs.js","mtime":1618923176918},{"path":"/Library/WebServer/Documents/Projects/vue/m-driver-dashboard/node_modules/vue-loader/lib/index.js","mtime":1618923178100}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBmaXJlYmFzZSBmcm9tICIuLi8uLi9wbHVnaW5zL2ZpcmViYXNlIjsKY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTsKY29uc3QgcmVmID0gZGIuY29sbGVjdGlvbigiZHJpdmVySGlzdG9yaWVzIik7CmNvbnN0IG15RWFybmluZ1JlZiA9IGRiLmNvbGxlY3Rpb24oImRhaWx5RWFybmluZ3MiKTsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0cmlwc0RldGFpbDoge30sCiAgICAgIHRyaXBzSW5mbzogW10sCiAgICAgIGRhaWx5RWFybmluZ0RldGFpbDoge30sCiAgICAgIGF1dGhVc2VyOiB7fSwKICAgICAgc2VhcmNoOiAiIiwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdHJpcEhpc3RvcnkoKSB7CiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMudHJpcHNEZXRhaWwpLmZpbHRlcigoZWwpID0+IGVsLnBhcmVudERhdGUpOwogICAgfSwKICAgIHRyaXBGaWx0ZXJEYXRhKCkgewogICAgICByZXR1cm4gdGhpcy50cmlwc0luZm8uZmlsdGVyKChlbGUpID0+IHsKICAgICAgICByZXR1cm4gKAogICAgICAgICAgZWxlLnBhcmVudERhdGUuaW5jbHVkZXModGhpcy5zZWFyY2gpICYmCiAgICAgICAgICBlbGUudXNlciAmJgogICAgICAgICAgZWxlLnVzZXIudXNlckZ1bGxOYW1lCiAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgIC5pbmNsdWRlcyh0aGlzLnNlYXJjaC50b0xvd2VyQ2FzZSgpKSAmJgogICAgICAgICAgZWxlLnBpY2tVcExvY2F0aW9uLml0ZW1UaXRsZS5pbmNsdWRlcyh0aGlzLnNlYXJjaCkgJiYKICAgICAgICAgIGVsZS5kcm9wT2ZmTG9jYXRpb24uaXRlbVRpdGxlLmluY2x1ZGVzKHRoaXMuc2VhcmNoKSAmJgogICAgICAgICAgZWxlLmZpbmFsUHJpY2UgJiYKICAgICAgICAgIGVsZS5maW5hbFByaWNlLmluY2x1ZGVzKHRoaXMuc2VhcmNoKSAmJgogICAgICAgICAgZWxlLm15X2Vhcm5pbmdzICYmCiAgICAgICAgICBlbGUubXlfZWFybmluZ3MuaW5jbHVkZXModGhpcy5zZWFyY2gpICYmCiAgICAgICAgICBlbGUudml0ZV9mZWVzICYmCiAgICAgICAgICBlbGUudml0ZV9mZWVzLmluY2x1ZGVzKHRoaXMuZnNlYXJjaCkKICAgICAgICApOwogICAgICB9KTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5hdXRoVXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImF1dGhVc2VyIikpOwogICAgdGhpcy5nZXRUcmlwSGlzdG9yeSgpOwogICAgdGhpcy5nZXREYWlseUVhcm5pbmdzKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRUcmlwSGlzdG9yeSgpIHsKICAgICAgcmVmCiAgICAgICAgLmRvYyh0aGlzLmF1dGhVc2VyLmRyaXZlcklkKQogICAgICAgIC5nZXQoKQogICAgICAgIC50aGVuKChzbmFwc2hvdCkgPT4gewogICAgICAgICAgdGhpcy50cmlwc0RldGFpbCA9IHsgLi4uc25hcHNob3QuZGF0YSgpIH07CiAgICAgICAgICBjb25zdCBkZXRhaWxzID0gT2JqZWN0LnZhbHVlcyh0aGlzLnRyaXBzRGV0YWlsKTsKICAgICAgICAgIGRldGFpbHMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgaWYgKGl0ZW0uZmluYWxQcmljZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW0uZmluYWxQcmljZSk7CiAgICAgICAgICAgICAgdGhpcy50cmlwc0luZm8ucHVzaCh7CiAgICAgICAgICAgICAgICAuLi5pdGVtLAogICAgICAgICAgICAgICAgbXlfZWFybmluZ3M6IGAke01hdGguY2VpbCgKICAgICAgICAgICAgICAgICAgaXRlbS5maW5hbFByaWNlIC0gaXRlbS5maW5hbFByaWNlICogMC4xCiAgICAgICAgICAgICAgICApfWAsCiAgICAgICAgICAgICAgICB2aXRlX2ZlZXM6IGAke01hdGguY2VpbChpdGVtLmZpbmFsUHJpY2UgKiAwLjEpfWAsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gKHsKICAgICAgICAgIGVycm9yQ29kZTogZXJyb3IuY29kZSwKICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IubWVzc2FnZSwKICAgICAgICB9KSk7CiAgICB9LAogICAgZ2V0RGFpbHlFYXJuaW5ncygpIHsKICAgICAgbXlFYXJuaW5nUmVmCiAgICAgICAgLmRvYyh0aGlzLmF1dGhVc2VyLmRyaXZlcklkKQogICAgICAgIC5nZXQoKQogICAgICAgIC50aGVuKChzbmFwc2hvdCkgPT4gewogICAgICAgICAgdGhpcy5kYWlseUVhcm5pbmdEZXRhaWwgPSB7IC4uLnNuYXBzaG90LmRhdGEoKSB9OwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gKHsKICAgICAgICAgIGVycm9yQ29kZTogZXJyb3IuY29kZSwKICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3IubWVzc2FnZSwKICAgICAgICB9KSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["TripHistory.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TripHistory.vue","sourceRoot":"src/components/DashboardComponents","sourcesContent":["<template>\n  <div>\n    <el-card class=\"box-card\" shadow=\"always\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"18\">\n          <div class=\"o-card-title-3\">\n            Trip History\n          </div>\n        </el-col>\n        <el-col :span=\"6\">\n          <el-input\n            placeholder=\"Search Trips...\"\n            v-model=\"search\"\n            clearable=\"\"\n          ></el-input>\n        </el-col>\n      </el-row>\n      <el-row :gutter=\"20\">\n        <el-col :span=\"24\">\n          <el-table :data=\"tripFilterData\" stripe style=\"width: 100%\">\n            <el-table-column label=\"Date\">\n              <template slot-scope=\"props\">\n                {{ props.row.parentDate }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Rider\">\n              <template slot-scope=\"props\">\n                {{ props.row.user ? props.row.user.userFullName : \"--\" }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Ride Status\">\n              <template slot-scope=\"props\">\n                {{ props.row.rideStatus }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Pickup\">\n              <template slot-scope=\"props\">\n                {{\n                  props.row.pickUpLocation\n                    ? props.row.pickUpLocation.itemTitle\n                    : \"\"\n                }}\n              </template>\n            </el-table-column>\n\n            <el-table-column label=\"Dropoff\">\n              <template slot-scope=\"props\">\n                {{\n                  props.row.pickUpLocation\n                    ? props.row.pickUpLocation.itemTitle\n                    : \"\"\n                }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Total Price\">\n              <template slot-scope=\"props\">\n                {{ props.row.finalPrice }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Earning\">\n              <template slot-scope=\"props\">\n                {{ props.row.my_earnings }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"Vite Fee\">\n              <template slot-scope=\"props\">\n                {{ props.row.vite_fees }}\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-col>\n      </el-row>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport firebase from \"../../plugins/firebase\";\nconst db = firebase.firestore();\nconst ref = db.collection(\"driverHistories\");\nconst myEarningRef = db.collection(\"dailyEarnings\");\nexport default {\n  data() {\n    return {\n      tripsDetail: {},\n      tripsInfo: [],\n      dailyEarningDetail: {},\n      authUser: {},\n      search: \"\",\n    };\n  },\n  computed: {\n    tripHistory() {\n      return Object.values(this.tripsDetail).filter((el) => el.parentDate);\n    },\n    tripFilterData() {\n      return this.tripsInfo.filter((ele) => {\n        return (\n          ele.parentDate.includes(this.search) &&\n          ele.user &&\n          ele.user.userFullName\n            .toLowerCase()\n            .includes(this.search.toLowerCase()) &&\n          ele.pickUpLocation.itemTitle.includes(this.search) &&\n          ele.dropOffLocation.itemTitle.includes(this.search) &&\n          ele.finalPrice &&\n          ele.finalPrice.includes(this.search) &&\n          ele.my_earnings &&\n          ele.my_earnings.includes(this.search) &&\n          ele.vite_fees &&\n          ele.vite_fees.includes(this.fsearch)\n        );\n      });\n    },\n  },\n  created() {\n    this.authUser = JSON.parse(localStorage.getItem(\"authUser\"));\n    this.getTripHistory();\n    this.getDailyEarnings();\n  },\n  methods: {\n    getTripHistory() {\n      ref\n        .doc(this.authUser.driverId)\n        .get()\n        .then((snapshot) => {\n          this.tripsDetail = { ...snapshot.data() };\n          const details = Object.values(this.tripsDetail);\n          details.forEach((item, index) => {\n            if (item.finalPrice) {\n              console.log(item.finalPrice);\n              this.tripsInfo.push({\n                ...item,\n                my_earnings: `${Math.ceil(\n                  item.finalPrice - item.finalPrice * 0.1\n                )}`,\n                vite_fees: `${Math.ceil(item.finalPrice * 0.1)}`,\n              });\n            }\n          });\n        })\n        .catch((error) => ({\n          errorCode: error.code,\n          errorMessage: error.message,\n        }));\n    },\n    getDailyEarnings() {\n      myEarningRef\n        .doc(this.authUser.driverId)\n        .get()\n        .then((snapshot) => {\n          this.dailyEarningDetail = { ...snapshot.data() };\n        })\n        .catch((error) => ({\n          errorCode: error.code,\n          errorMessage: error.message,\n        }));\n    },\n  },\n};\n</script>\n"]}]}